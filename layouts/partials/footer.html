{{- if not (.Param "hideFooter") }}
    <footer class="footer">
        {{- if .Site.Copyright }}
            <span>{{ .Site.Copyright | markdownify }}</span>
        {{- else }}
            <span>&copy; {{ now.Year }} <a href="{{ "" | absLangURL }}">{{ .Site.Title }}</a></span>
        {{- end }}
        <a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">
            豫ICP备20012967号-1</a>
        &nbsp;|&nbsp;
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        PaperMod&nbsp;|&nbsp;
        <a href="https://www.sulvblog.cn" rel="noopener noreferrer" target="_blank">Sulv's Blog</a>
    </footer>
{{- end }}

{{- if (not .Site.Params.disableScrollToTop) }}
    <a href="#top" class="top-link">
        ^
    </a>
{{- end }}

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>

{{- if (not .Site.Params.disableScrollToTop) }}
    <script>
        var mybutton = document.getElementById("top-link");
        window.onscroll = function () {
            if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
                mybutton.style.visibility = "visible";
                mybutton.style.opacity = "1";
            } else {
                mybutton.style.visibility = "hidden";
                mybutton.style.opacity = "0";
            }
        };

    </script>
{{- end }}

{{- if (not .Site.Params.disableThemeToggle) }}
    <script>
        document.getElementById("theme-toggle").addEventListener("click", () => {
            if (document.body.className.includes("dark")) {
                document.body.classList.remove('dark');
                localStorage.setItem("pref-theme", 'light');
            } else {
                document.body.classList.add('dark');
                localStorage.setItem("pref-theme", 'dark');
            }
        })
    </script>
{{- end }}

{{- if hugo.IsProduction | or (eq .Site.Params.env "production") }}
    <script defer>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?7af2e1746336480a39dd4092b5a11911";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
{{- end -}}

{{- $visitor := hugo.IsProduction }}
<script src="https://cdn.staticfile.org/waline/1.5.4/Waline.min.js"></script>
<script>
    var visitor = Boolean({{ $visitor }})
    new Waline({
        el: '#vcomments',
        avatar: 'hide',
        visitor: visitor,
        meta: ['nick', 'mail'],
        requiredFields: ['nick'],
        serverURL: 'https://comments.ziying.site',
        dark: 'auto'
    })
</script>

<script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.6.0/jquery.min.js" type="application/javascript"></script>
<script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/bootstrap/4.6.1/js/bootstrap.min.js" type="application/javascript"></script>

<script>
    (function ($) {
        "use strict";


        /* -----------------------------------
                Navigation
        ----------------------------------- */
        $('.navbar-toggler').on('click', function () {
            $('.navbar-collapse').collapse('show');
        });


    })(jQuery);


</script>

